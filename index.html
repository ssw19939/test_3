<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HG Oracle Deck Selector</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --card-back: #2c3e50;
            --card-accent: #e74c3c;
            --text-color: #ecf0f1;
            --modal-bg: rgba(0, 0, 0, 0.9);
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* ì»¨íŠ¸ë¡¤ ì˜ì—­ */
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        select, button {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
        }

        button.primary {
            background-color: var(--card-accent);
            color: white;
            font-weight: bold;
            display: none; /* ì„ íƒ ì „ì—” ìˆ¨ê¹€ */
        }

        /* ì¹´ë“œ ê·¸ë¦¬ë“œ ì˜ì—­ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            width: 100%;
            max-width: 800px;
            padding-bottom: 80px;
        }

        .card-slot {
            aspect-ratio: 2/3;
            background-color: var(--card-back);
            border-radius: 6px;
            border: 2px solid #444;
            cursor: pointer;
            position: relative;
            transition: transform 0.2s, border-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #aaa;
        }

        .card-slot:hover {
            transform: translateY(-5px);
            border-color: #888;
        }

        .card-slot.selected {
            border-color: var(--card-accent);
            box-shadow: 0 0 10px var(--card-accent);
            transform: translateY(-10px);
        }

        .card-slot.selected::after {
            content: 'âœ“';
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--card-accent);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        /* ê²°ê³¼ ëª¨ë‹¬ (ê°€ì±  ì—°ì¶œ) */
        .modal {
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-bg);
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            display: flex;
            gap: 20px;
            perspective: 1000px;
        }

        /* ë’¤ì§‘íˆëŠ” ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .reveal-card {
            width: 200px;
            aspect-ratio: 2/3;
            position: relative;
            transform-style: preserve-3d;
            opacity: 0; /* ë“±ì¥ ì „ íˆ¬ëª… */
            transform: scale(0.5) translateY(50px);
        }

        .reveal-card.animate {
            animation: popAndFlip 0.8s forwards ease-out;
        }

        @keyframes popAndFlip {
            0% {
                opacity: 0;
                transform: scale(0.5) translateY(50px) rotateY(0deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.1) translateY(0) rotateY(0deg); /* íŠ€ì–´ë‚˜ì˜¤ëŠ” ëŠë‚Œ */
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0) rotateY(180deg); /* ë’¤ì§‘í˜ */
            }
        }

        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
        }

        .face.back {
            background: repeating-linear-gradient(
                45deg,
                #2c3e50,
                #2c3e50 10px,
                #34495e 10px,
                #34495e 20px
            );
            color: transparent;
        }

        .face.front {
            background-color: white;
            color: #333;
            transform: rotateY(180deg);
        }

        .face.front img {
            width: 100%;
            height: 80%;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 10px;
            background: #eee; /* ì´ë¯¸ì§€ ì—†ì„ ë•Œ ë°°ê²½ */
        }
        
        .face.front h3 {
            margin: 0;
            font-size: 16px;
            word-break: keep-all;
        }

        .close-btn {
            margin-top: 30px;
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 10px 30px;
            opacity: 0;
            transition: opacity 0.5s;
        }

    </style>
</head>
<body>

    <div class="controls">
        <select id="deckSelector" onchange="changeDeck()">
            <option value="lenormand">ë ˆë…¸ë¨¼ë“œ (36ì¥)</option>
            <option value="horoscope">í˜¸ë¡œìŠ¤ì½”í”„/ë²¨ë¦° (53ì¥)</option>
            <option value="tarot">ìœ ë‹ˆë²„ì…œ ì›¨ì´íŠ¸ (78ì¥)</option>
        </select>
        <button id="resultBtn" class="primary" onclick="showResult()">ê²°ê³¼ í™•ì¸ (0/3)</button>
    </div>

    <div id="grid" class="grid-container">
        </div>

    <div id="gachaModal" class="modal">
        <div class="modal-content" id="revealArea">
            </div>
        <button class="close-btn" id="closeBtn" onclick="closeModal()">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <script>
        // --- 1. ë°ì´í„° ì •ì˜ (ì¹´ë“œ ë§¤í•‘) ---
        const decks = {
            lenormand: {
                count: 36,
                names: {
                    1: "ê¸°ìˆ˜ (Rider)", 2: "í´ë¡œë²„ (Clover)", 3: "ë°° (Ship)", 4: "ì§‘ (House)", 5: "ë‚˜ë¬´ (Tree)", 6: "êµ¬ë¦„ (Clouds)",
                    7: "ë±€ (Snake)", 8: "ê´€ (Coffin)", 9: "ë¶€ì¼€ (Bouquet)", 10: "ë‚« (Scythe)", 11: "ì±„ì° (Whip)", 12: "ìƒˆ (Birds)",
                    13: "ì–´ë¦°ì´ (Child)", 14: "ì—¬ìš° (Fox)", 15: "ê³° (Bear)", 16: "ë³„ (Stars)", 17: "í™©ìƒˆ (Stork)", 18: "ê°œ (Dog)",
                    19: "íƒ‘ (Tower)", 20: "ì •ì› (Garden)", 21: "ì‚° (Mountain)", 22: "ê¸¸ (Crossroad)", 23: "ì¥ (Mice)", 24: "í•˜íŠ¸ (Heart)",
                    25: "ë°˜ì§€ (Ring)", 26: "ì±… (Book)", 27: "í¸ì§€ (Letter)", 28: "ì‹ ì‚¬ (Gentleman)", 29: "ìˆ™ë…€ (Lady)", 30: "ë°±í•© (Lily)",
                    31: "íƒœì–‘ (Sun)", 32: "ë‹¬ (Moon)", 33: "ì—´ì‡  (Key)", 34: "ë¬¼ê³ ê¸° (Fish)", 35: "ë‹» (Anchor)", 36: "ì‹­ìê°€ (Cross)"
                }
            },
            horoscope: {
                count: 53,
                names: {
                    1: "ìš´ëª…", 2: "ë‚¨ìì˜ ë³„", 3: "ì—¬ìì˜ ë³„", 4: "ì¶œìƒ", 5: "ì„±ê³µ", 6: "ìƒìŠ¹", 7: "ëª…ì˜ˆ", 8: "ìƒê°/ìš°ì •", 9: "ì‹œê³¨", 10: "ì„ ë¬¼",
                    11: "ë°°ì‹ ", 12: "ì¶œë°œ", 13: "ë¶ˆë³€", 14: "ë°œê²¬", 15: "ë¬¼/ì—¬í–‰", 16: "ê°€ì •", 17: "ì§ˆë³‘", 18: "ë³€í™”", 19: "ëˆ/í’ìš”", 20: "ì§€ëŠ¥",
                    21: "ë„ë‘‘", 22: "ì‚¬ì—…", 23: "êµí†µ/ê±°ë˜", 24: "ë‰´ìŠ¤", 25: "ì¦ê±°ì›€", 26: "í‰í™”", 27: "ê²°í•©", 28: "ê°€ì¡±", 29: "ì‚¬ë‘", 30: "í…Œì´ë¸”",
                    31: "ì—´ì •", 32: "ì‚¬ì•…í•¨", 33: "ì†Œì†¡", 34: "ë…ì¬", 35: "ì ", 36: "í˜‘ìƒ", 37: "ë¶ˆ", 38: "ì‚¬ê³ ", 39: "ì§€ì›/ë³´í˜¸", 40: "ì•„ë¦„ë‹¤ì›€",
                    41: "ìœ ì‚°", 42: "ì§€í˜œ", 43: "ëª…ì„±", 44: "ìš°ì—°", 45: "í–‰ë³µ", 46: "ë¶ˆí–‰", 47: "ë¶ˆì„", 48: "ìˆ™ëª…", 49: "ì€ì´", 50: "íŒŒë©¸",
                    51: "ì§€ì²´", 52: "ìˆ˜ë„ì›", 53: "ë¸”ë£¨ ì¹´ë“œ"
                }
            },
            tarot: {
                count: 78,
                names: {} // ì•„ë˜ì—ì„œ ìë™ ìƒì„±
            }
        };

        // íƒ€ë¡œ ë°ì´í„° ìƒì„± (Major 0-21, Minor 56)
        const majors = ["ë°”ë³´","ë§ˆë²•ì‚¬","ê³ ìœ„ ì—¬ì‚¬ì œ","ì—¬í™©ì œ","í™©ì œ","êµí™©","ì—°ì¸","ì „ì°¨","í˜","ì€ë‘”ì","ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´","ì •ì˜","ë§¤ë‹¬ë¦° ì‚¬ëŒ","ì£½ìŒ","ì ˆì œ","ì•…ë§ˆ","íƒ‘","ë³„","ë‹¬","íƒœì–‘","ì‹¬íŒ","ì„¸ê³„"];
        const suits = ["Wands", "Cups", "Swords", "Pentacles"];
        const ranks = ["Ace", "2", "3", "4", "5", "6", "7", "8", "9", "10", "Page", "Knight", "Queen", "King"];
        
        // ë©”ì´ì € ë§¤í•‘
        majors.forEach((name, i) => decks.tarot.names[i] = `${i}. ${name}`);
        // ë§ˆì´ë„ˆ ë§¤í•‘
        let tIndex = 22;
        suits.forEach(suit => {
            ranks.forEach(rank => {
                decks.tarot.names[tIndex] = `${rank} of ${suit}`;
                tIndex++;
            });
        });

        // --- 2. ìƒíƒœ ê´€ë¦¬ ---
        let currentDeck = 'lenormand';
        let selectedIndices = [];
        const MAX_SELECTION = 3;

        // --- 3. ë¡œì§ êµ¬í˜„ ---
        const gridEl = document.getElementById('grid');
        const btnEl = document.getElementById('resultBtn');

        function init() {
            changeDeck();
        }

        function changeDeck() {
            currentDeck = document.getElementById('deckSelector').value;
            selectedIndices = [];
            renderGrid();
            updateButton();
        }

        function renderGrid() {
            gridEl.innerHTML = '';
            const deck = decks[currentDeck];
            
            for(let i = 1; i <= deck.count; i++) { // ë³´í†µ íŒŒì¼ëª… 1ë¶€í„° ì‹œì‘ ê°€ì •
                // íƒ€ë¡œì˜ ê²½ìš° 0ë²ˆë¶€í„° ì‹œì‘ì´ë©´ ì¡°ì • í•„ìš”. ì—¬ê¸°ì„  í¸ì˜ìƒ 1~countë¡œ ë£¨í”„ ëŒê³ ,
                // íƒ€ë¡œ ë°ì´í„° ì ‘ê·¼ì‹œ (i-1) ë¡œì§ì„ ì“°ê±°ë‚˜ ë°ì´í„° í‚¤ë¥¼ ë§ì¶¤.
                // *ìœ„ ë°ì´í„°ì—ì„œ íƒ€ë¡œ í‚¤ëŠ” 0~77ì´ë¯€ë¡œ, íƒ€ë¡œì¼ë•Œë§Œ ì¸ë±ìŠ¤ ì¡°ì •*
                
                let dataIndex = (currentDeck === 'tarot') ? i - 1 : i;

                const card = document.createElement('div');
                card.className = 'card-slot';
                card.textContent = "Back"; // ë’·ë©´ í…ìŠ¤íŠ¸ (ì´ë¯¸ì§€ ì—†ì„ ë•Œ)
                
                // í´ë¦­ ì´ë²¤íŠ¸
                card.onclick = () => toggleSelection(card, dataIndex);
                
                gridEl.appendChild(card);
            }
        }

        function toggleSelection(el, index) {
            if (selectedIndices.includes(index)) {
                // ì„ íƒ í•´ì œ
                selectedIndices = selectedIndices.filter(i => i !== index);
                el.classList.remove('selected');
            } else {
                // ì„ íƒ ì¶”ê°€
                if (selectedIndices.length < MAX_SELECTION) {
                    selectedIndices.push(index);
                    el.classList.add('selected');
                } else {
                    alert(`ìµœëŒ€ ${MAX_SELECTION}ì¥ê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                    return;
                }
            }
            updateButton();
        }

        function updateButton() {
            btnEl.textContent = `ê²°ê³¼ í™•ì¸ (${selectedIndices.length}/${MAX_SELECTION})`;
            if (selectedIndices.length === MAX_SELECTION) {
                btnEl.style.display = 'block';
            } else {
                btnEl.style.display = 'none';
            }
        }

        // --- 4. ê°€ì±  ì—°ì¶œ ë¡œì§ ---
        function showResult() {
            const modal = document.getElementById('gachaModal');
            const revealArea = document.getElementById('revealArea');
            const closeBtn = document.getElementById('closeBtn');
            
            revealArea.innerHTML = '';
            closeBtn.style.opacity = '0';
            modal.style.display = 'flex';

            // ì„ íƒëœ ì¹´ë“œ DOM ìƒì„± (ì•„ì§ íˆ¬ëª… ìƒíƒœ)
            selectedIndices.forEach((idx, i) => {
                const name = decks[currentDeck].names[idx];
                
                // ì‹¤ì œ ì´ë¯¸ì§€ ê²½ë¡œ (ì˜ˆì‹œ)
                // const imgSrc = `/images/${currentDeck}/${idx}.jpg`; 
                
                const cardWrap = document.createElement('div');
                cardWrap.className = 'reveal-card';
                
                // ì¹´ë“œ ì•ë’¤ êµ¬ì„±
                cardWrap.innerHTML = `
                    <div class="face back">HG</div>
                    <div class="face front">
                        <div style="font-size:40px; margin-bottom:10px;">ğŸ”®</div>
                        <h3>${name}</h3>
                    </div>
                `;
                
                revealArea.appendChild(cardWrap);

                // ìˆœì°¨ ì• ë‹ˆë©”ì´ì…˜ (0.6ì´ˆ ê°„ê²©)
                setTimeout(() => {
                    cardWrap.classList.add('animate');
                    // íš¨ê³¼ìŒ ì¬ìƒ ê°€ëŠ¥: playSound();
                }, i * 600);
            });

            // ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚˜ë©´ ë‹«ê¸° ë²„íŠ¼ í‘œì‹œ
            setTimeout(() => {
                closeBtn.style.opacity = '1';
            }, selectedIndices.length * 600 + 500);
        }

        function closeModal() {
            document.getElementById('gachaModal').style.display = 'none';
            // ë¦¬ì…‹í•˜ë ¤ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
            // changeDeck(); 
        }

        // ì´ˆê¸° ì‹¤í–‰
        init();

    </script>
</body>
</html>
